{% extends 'bodyBase.html.twig' %}

{% block title %}Invitation{% endblock %}

{% block content %}
    <div class="admin-contentContainer">
        <div class="card">
            <div class="card-content">
                <span class="card-title">Invitation</span>
                {% if sent is defined and sent.completed is defined and sent.completed == true %}
                    <div style="padding: 20px 0">
                        Invitation has been sent successfully to the "{{ sent.address }}" email address
                    </div>
                    <a class="waves-effect waves-light btn" href="{{ path('associate_invite') }}">Send another one</a>
                {% else %}
                    {{ form_start(invitation) }}
                    <div class="invitation-item" >
                        <div class="input-field col s12">
                            {{ form_widget(invitation.fullName) }}
                            {{ form_label(invitation.fullName)}}
                            {% include 'includes/errorBlock.html.twig' with { field: invitation.fullName } %}
                        </div>
                    </div>
                    <div class="invitation-item" >
                        <div class="input-field col s12">
                            {{ form_widget(invitation.email) }}
                            {{ form_label(invitation.email) }}
                            {% include 'includes/errorBlock.html.twig' with { field: invitation.email } %}
                        </div>
                    </div>
                    <div class="invitation-buttonWrap">
                        {{ form_widget(invitation.submit, { 'attr': {'style': 'background-color:#3ab54a'} }) }}
                    </div>
                    {{ form_end(invitation) }}
                    <div class="invitation-messageContainer">
                        <div id="flash-messages">
                            {% for message in app.flashes('error') %}
                                <div class="error__block">
                                    {{ message }}
                                </div>
                            {% endfor %}
                            {% for message in app.flashes('success') %}
                                <div class="success__block">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% if sent is not defined %}
        <div class="admin-contentContainer sentInvitations">
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Sent Invitations</span>
                    <table>
                        <thead>
                        <tr>
                            <th>Email</th>
                            <th>Full Name</th>
                            <th>Invitation created</th>
                            <th>Invitation sent</th>
                            <th>Resend</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for inv in invitations %}
                            <tr>
                                <td>{{ inv.email }}</td>
                                <td>{{ inv.fullName }}</td>
                                <td>{{ inv.created | date }}</td>
                                {% if inv.used == true %}
                                    <td>Yes</td>
                                {% else %}
                                    <td>No</td>
                                {% endif %}
                                <td><a href="{{ path('associate_invite', {invitationId: inv.id}) }}" class="btn">Resend Invitation</a></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <br>
                    <ul class="pagination" style="text-align: center">
                        {% if currentPage == 1 %}
                            <li class="disabled"><a href="#!"><i class="material-icons">chevron_left</i></a></li>
                        {% else %}
                            <li class="waves-effect"><a href="{{ path('associate_invite', { page: (currentPage-1)}) }}"><i class="material-icons">chevron_left</i></a></li>
                        {% endif %}
                        {% for page in 1..numberOfPages %}
                            {% if page == currentPage %}
                                <li class="active"><a href="#!">{{ currentPage }}</a></li>
                            {% else %}
                                <li class="waves-effect"><a href="{{ path('associate_invite', { page: page}) }}">{{ page }}</a></li>
                            {% endif %}
                        {% endfor %}
                        {% if currentPage == numberOfPages %}
                            <li class="disabled"><a href="#!"><i class="material-icons">chevron_right</i></a></li>
                        {% else %}
                            <li class="waves-effect"><a href="{{ path('associate_invite', { page: (currentPage+1)}) }}"><i class="material-icons">chevron_right</i></a></li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}